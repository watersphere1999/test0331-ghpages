{"version":3,"sources":["pages/HikingFrontend/Verify2.js"],"names":["useStyles","makeStyles","theme","container","display","flexDirection","height","width","root","margin","spacing","justifyContent","padding","textField","bottomBoard","createMuiTheme","palette","primary","light","main","dark","contrastText","api","axios","create","baseURL","Verify2","props","classes","useState","code_one","code_two","code_three","code_four","submitted","state","setState","codeOneInput","useRef","codeTwoInput","codeThreeInput","codeFourInput","number1","setNumber1","number2","setNumber2","number3","setNumber3","number4","setNumber4","headers","localStorage","getItem","console","log","handleCodeChange","e","target","id","value","length","prevState","current","focus","backspaceTrigger","keyCode","code","setCode","continueButton","a","firstUpdate","useLayoutEffect","postBack","history","useHistory","error","setError","makesure","setMakesure","responsedJson","post","then","response","data","setItem","JSON","stringify","parse","push","catch","errorText","finally","emailHeaders","resentButton","className","style","fontSize","fontWeight","color","noValidate","autoComplete","autoFocus","inputRef","onChange","onKeyDown","sytyle","position","zIndex","disabled","onClick","variant","backgroundColor","borderColor","maxWidth","Height","borderRadius"],"mappings":"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","file":"static/js/40.8d27faed.chunk.js","sourcesContent":["import React, {useState, useRef, useEffect, useLayoutEffect} from 'react';\r\nimport {createMuiTheme, makeStyles, ThemeProvider} from '@material-ui/core/styles';\r\nimport { Typography } from '@material-ui/core';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\n\r\nimport PropTypes from 'prop-types';\r\nimport axios from 'axios';\r\n\r\nconst useStyles = makeStyles((theme)=>({\r\n    container: {\r\n        display:'flex',\r\n        flexDirection: 'column',  // flexDirection:'column' 使button strech 開來\r\n        height: '768px',\r\n        // width: '411px',\r\n        width: '100%'\r\n      },\r\n      root: {\r\n        '& > *': {\r\n          margin: theme.spacing(1),\r\n          width: '25ch',\r\n        },\r\n        display: 'flex',\r\n        justifyContent: 'space-around',\r\n        padding: '0 73px 0 74px',\r\n        // flexWrap: 'wrap',\r\n      },\r\n      textField:{\r\n          width: '54px',\r\n          height: '40px',\r\n          margin: '48px 0 0',\r\n          padding: '9px 0 0',\r\n      },\r\n}))\r\nconst bottomBoard = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#00d04c',\r\n      main: '#00d04c',\r\n      dark: '#00d04c',\r\n      contrastText: '#00d04c',\r\n    },\r\n  },\r\n});\r\n\r\nconst api = axios.create({\r\n  baseURL: \"https://gohiking-server.herokuapp.com/\",\r\n  // baseURL: \"https://go-hiking-backend-laravel.herokuapp.com/\",\r\n});\r\n\r\n\r\nexport default function Verify2(props){\r\n    const classes = useStyles();\r\n    const [state , setState] = useState({\r\n      code_one:'',\r\n      code_two:'',\r\n      code_three:'',\r\n      code_four:'',\r\n      submitted:false,\r\n    })\r\n\r\n    const codeOneInput = useRef(null);\r\n    const codeTwoInput = useRef(null);\r\n    const codeThreeInput = useRef(null);\r\n    const codeFourInput = useRef(null);\r\n\r\n    var [number1, setNumber1] = useState(-1);\r\n    var [number2, setNumber2] = useState(-1);\r\n    var [number3, setNumber3] = useState(-1);\r\n    var [number4, setNumber4] = useState(-1);\r\n\r\n    const headers = {\r\n      'Email': localStorage.getItem('Email')\r\n    }\r\n    console.log(headers);\r\n\r\n    const handleCodeChange = (e) => {\r\n      const {id , value} = e.target\r\n      if(value.length < 2){\r\n          setState(prevState => ({\r\n              ...prevState,\r\n              [id] : value\r\n          }))\r\n          if(id=='code_one' && value.length >0){\r\n              setNumber1(number1 = value); \r\n              console.log(number1);\r\n              codeTwoInput.current.focus();\r\n          }\r\n          \r\n          if(id=='code_two' && value.length >0){\r\n              setNumber2(number2 = value); \r\n              console.log(number2);\r\n              codeThreeInput.current.focus();\r\n          }\r\n          if(id=='code_three' && value.length >0){             \r\n              setNumber3(number3 = value); \r\n              console.log(number3);\r\n              codeFourInput.current.focus();\r\n          }\r\n          if(id=='code_four' && value.length >0){              \r\n              setNumber4(number4 = value); \r\n              console.log(number4);\r\n        }\r\n      }\r\n    }\r\n        const backspaceTrigger = (e) =>{\r\n          if (e.keyCode === 8 && e.target.id ==='code_two'){\r\n            if(e.target.value != ''){\r\n              codeTwoInput.current.focus();\r\n            }else{\r\n              codeOneInput.current.focus();\r\n            }\r\n          }\r\n          if (e.keyCode === 8 && e.target.id ==='code_three'){\r\n            if(e.target.value != ''){\r\n              codeThreeInput.current.focus();\r\n            }else{\r\n              codeTwoInput.current.focus();\r\n            }\r\n          }\r\n          if (e.keyCode === 8 && e.target.id ==='code_four'){\r\n            if(e.target.value === ''){\r\n              codeThreeInput.current.focus();\r\n            } else{\r\n              codeFourInput.current.focus();\r\n            }\r\n            \r\n          }\r\n        }\r\n      //這邊開始處理input進來的文字\r\n        var [code, setCode] = useState({\r\n          \"verificationCode0\": null,\r\n          \"verificationCode1\": null,\r\n          \"verificationCode2\": null,\r\n          \"verificationCode3\": null,\r\n        })\r\n\r\n        const continueButton = async() => {\r\n          console.log(\"code is like this before: \"+ code);\r\n          setCode({\r\n            \"verificationCode0\": number1,\r\n            \"verificationCode1\": number2,\r\n            \"verificationCode2\": number3,\r\n            \"verificationCode3\": number4,\r\n          })\r\n          console.log(\"code is like this after: \"+ code);\r\n        }\r\n        \r\n        //這邊是處理code更新的部分\r\n        const firstUpdate = useRef(true);\r\n        useLayoutEffect(()=>{\r\n          if (firstUpdate.current){\r\n            firstUpdate.current = false;\r\n            return;\r\n          }    \r\n          console.log('code is like this Effect: ');\r\n          postBack();      \r\n        },[code]);\r\n      \r\n      // 這邊是POST的部分\r\n      const history = useHistory();\r\n      const [error, setError] = useState('');\r\n      const [makesure, setMakesure] = useState('');\r\n\r\n      var responsedJson = '';\r\n        const postBack = async() =>{\r\n          console.log(code);\r\n          await api.post('api/password/confirm', code).then(function (response) {\r\n            console.log('驗證碼正確');\r\n            console.log(response.data);\r\n            localStorage.setItem('token', JSON.stringify(response.data));\r\n            console.log(JSON.parse(localStorage.getItem('token')));\r\n            console.log('得到token!');\r\n            console.log('ready to go');\r\n            history.push('/ResetPassword')\r\n          })\r\n          .catch(function (error) {\r\n            console.log('error');\r\n            responsedJson = error.response.data;\r\n            console.log('錯誤資訊如下: '+ responsedJson.error);\r\n            let errorText = \"錯誤資訊: \" + responsedJson.error;\r\n            setError(errorText);\r\n          })\r\n          .finally(function () {\r\n            console.log(responsedJson);\r\n          });  \r\n        }\r\n        //這裡是重寄驗證碼按鈕的部分\r\n        const emailHeaders = {\r\n          'email': localStorage.getItem('email')\r\n        }\r\n        const resentButton = async() =>{\r\n          setError('');\r\n          console.log(emailHeaders);\r\n          await api.post('api/password/forget', emailHeaders).then(function (response) {\r\n            console.log('重新寄送成功!');\r\n            setMakesure('重新寄送成功!');\r\n            responsedJson = response.data;\r\n          })\r\n          .catch(function (error) {\r\n            console.log('重新寄送失敗!');\r\n            let errorText = \"重新寄送失敗: \" + responsedJson.error;\r\n            setError(errorText);\r\n            responsedJson = error.response.data;\r\n          })\r\n          .finally(function () {\r\n            console.log(responsedJson);\r\n          });  \r\n        }\r\n        \r\n\r\n\r\n    return(        \r\n        <div className = {classes.container}>\r\n            <Typography style={{margin: '84px auto 0px', width: '123px', height: '36px', fontSize: '24px', fontWeight: '900'}}>輸入驗證碼</Typography>\r\n            <Typography style={{margin: '16px auto 0px', width: '379px', height: '42px', fontSize: '15px', fontWeight: '500', color: '#232323'}}>已把驗證碼發至您的信箱 johndoe@example.com，請確認您的信箱及輸入4位數驗證碼。</Typography>\r\n\r\n            <form className={classes.root} noValidate autoComplete=\"off\">\r\n              <ThemeProvider theme={bottomBoard}>\r\n                <TextField \r\n                  autoFocus\r\n                  className={classes.textField}\r\n                  id=\"code_one\"\r\n                  inputRef={codeOneInput} \r\n                  value={state.code_one}\r\n                  onChange={handleCodeChange}\r\n                  onKeyDown={backspaceTrigger}                  \r\n                />\r\n                <TextField                   \r\n                  className={classes.textField} \r\n                  id=\"code_two\"  \r\n                  inputRef={codeTwoInput}\r\n                  value={state.code_two}\r\n                  onChange={handleCodeChange}\r\n                  onKeyDown={backspaceTrigger}                  \r\n                />\r\n                <TextField \r\n                  className={classes.textField} \r\n                  id=\"code_three\"  \r\n                  inputRef={codeThreeInput}    \r\n                  value={state.code_three}              \r\n                  onChange={handleCodeChange}\r\n                  onKeyDown={backspaceTrigger} \r\n                />\r\n                <TextField \r\n                  className={classes.textField}\r\n                  id=\"code_four\" \r\n                  inputRef={codeFourInput} \r\n                  value={state.code_four}\r\n                  onChange={handleCodeChange} \r\n                  onKeyDown={backspaceTrigger} \r\n                  sytyle={{position:'relative', zIndex: '-10'}}           \r\n                />\r\n                </ThemeProvider>  \r\n            </form>\r\n\r\n            <Typography style={{margin: '16px auto 0 ',color: '#ff3b30' }}>{error} </Typography>\r\n            <Typography style={{margin: '0 auto 0 ',color: '#000000' }}>{makesure} </Typography>\r\n            <Button disabled= {state.submitted} onClick={continueButton}  variant = \"contained\"  style={{backgroundColor: '#00d04c',color: \"#ffffff\", fontWeight:\"700\" , borderColor: \"#00d04c\", width: \"92%\",maxWidth:\"379px\", Height: \"48px\", margin: \"27px auto 0\", borderRadius: '4px'}}>\r\n              繼續\r\n            </Button>\r\n            <Button variant = \"outlined\" onClick={resentButton} style={{color: \"#00d04c\", fontWeight:\"700\" , borderColor: \"#00d04c\",width: \"92%\",maxWidth:\"379px\", Height: \"48px\", margin: \"24px auto 0\", }}>\r\n              重新發送驗證碼\r\n            </Button>\r\n        </div>\r\n        \r\n        \r\n        );\r\n};\r\n\r\nVerify2.propTypes = {\r\n  width: PropTypes.oneOf(['lg', 'md', 'sm', 'xl', 'xs']).isRequired,\r\n};\r\n"],"sourceRoot":""}